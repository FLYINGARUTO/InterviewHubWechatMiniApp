{"version":3,"file":"login.js","sources":["pages/login.vue","pages/login.vue?type=page"],"sourcesContent":["<template>\n\t<view style=\"text-align: center;\">\n\t\t<view style=\"margin-top: 100px;\">\n\t\t\t<image style=\"width: 200px;\" src=\"/Users/flyingbuta/Desktop/Xiaomi-logo.png\" mode=\"widthFix\"></image>\n\t\t</view>\n\t\t<view style=\"padding: 0 30px;\">\n\t\t\t<uni-forms :rules=\"rules\" ref=\"formRef\" :model=\"formData\">\n\t\t\t\t<uni-forms-item name=\"username\">\n\t\t\t\t\t<uni-easyinput placeholder=\"请输入用户名...\" v-model=\"formData.username\" prefix-icon=\"contact\"></uni-easyinput>\n\t\t\t\t</uni-forms-item>\n\t\t\t\t<uni-forms-item name=\"password\"> \n\t\t\t\t\t<uni-easyinput type=\"password\" placeholder=\"请输入密码...\" v-model=\"formData.password\" prefix-icon=\"locked\"></uni-easyinput>\n\t\t\t\t</uni-forms-item>\n\t\t\t</uni-forms>\n\t\t\t<button class=\"round-button\" type=\"primary\" @tap=\"login\">登录</button>\n\t\t\t\n\t\t</view>\n\t\t<view class=\"other-action\">\n\t\t\t<text>忘记密码</text>\n\t\t\t<text @tap=\"toReg\">新用户注册</text>\n\t\t</view>\n\t\t\n\t\t<view class=\"bottom-view\"> \n\t\t\t<view class=\"icon\" style=\"background-color:#599ee3;\">\n\t\t\t\t<uni-icons  type=\"qq\" size=\"32\" color=\"white\"></uni-icons>\n\t\t\t</view>\n\t\t\t<view class=\"icon\" style=\"background-color: #07c160;\">\n\t\t\t\t<uni-icons type=\"weixin\" size=\"32\" color=\"white\"></uni-icons>\n\t\t\t</view>\n\t\t\t<view class=\"icon\" style=\"background-color: #fb666c;\">\n\t\t\t\t<uni-icons type=\"weibo\" size=\"32\" color=\"white\"></uni-icons>\n\t\t\t</view>\n\t\t\t \n\t\t</view>\n\t\t\n\t</view>\n</template>\n\n<script setup>\nimport { reactive,ref } from 'vue';\nimport storage from '../utils/storage';\nimport {useUserStore} from '../stores/user.js'\nconst formData=reactive({\n\tusername:\"\",\n\tpassword:\"\"\n})\nconst formRef=ref()\nconst rules={\n\tusername:{\n\t\trules:[\n\t\t\t{required: true,errorMessage:\"不能为空！\"},\n\t\t\t{minLength:3, maxLength:30, errorMessage:\"长度需在{minLength}~{maxLength}之间\"\t\t\t}\n\t\t]\n\t},\n\tpassword:{\n\t\trules:[\n\t\t\t{required:true,errorMessage:\"不能为空！\"},\n\t\t\t{minLength:5,maxLength:30, errorMessage:\"长度需在{minLength}~{maxLength}之间\"}\n\t\t]\n\t},\n}\nconst toReg=()=>{\n\tuni.navigateTo({\n\t\turl:\"/pages/reg/reg\"\n\t})\n}\nconst login=()=>{\n\tconst store=useUserStore()\n\tformRef.value.validate().then( res=>{\n\t\tconsole.log(\"表单规则验证通过：\",res)\n\t\t\n\t\tstore.login(formData.username,formData.password).then(async res=>{\n\t\t\tuni.showToast({\n\t\t\t\ttitle:\"login success\"\n\t\t\t})\n\t\t\tawait store.getUserInfo(storage.getStorageToken()) //获取token，解析为user对象存入pinia\n\t\t\tuni.switchTab({\n\t\t\t\turl:\"/pages/index/index\"\n\t\t\t})\n\t\t}).catch(err=>{\n\t\t\tconsole.log(\"login failed:\",err)\n\t\t})\n\t\t\n\t\n\t}).catch(err=>{\n\t\tconsole.log(\"错误信息：\",err)\n\t})\n}\n</script>\n\n<style lang=\"scss\">\n\t.other-action{\n\t\tpadding: 0 30px;\n\t\tcolor: cornflowerblue;\n\t\tjustify-content: space-between;\n\t\tdisplay: flex;\n\t}\n\t.bottom-view{\n\t\tbox-sizing: border-box;\n\t\tposition: absolute;\n\t\tbottom: 50px;\n\t\t\n\t\tdisplay: flex;\n\t\t\n\t\tjustify-content: space-around;\n\t\t\n\t\t\n\t\t\n\t\twidth: 100%;\n\t\t.icon{\n\t\t\twidth: 46px;\n\t\t\theight: 46px;\n\t\t\tborder-radius: 23px;\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\t}\n\t}\n</style>\n","import MiniProgramPage from '/Users/flyingbuta/Desktop/WechatMini/frontend/pages/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["reactive","ref","uni","useUserStore","res","storage","MiniProgramPage"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AA0CA,UAAM,WAASA,cAAAA,SAAS;AAAA,MACvB,UAAS;AAAA,MACT,UAAS;AAAA,IACV,CAAC;AACD,UAAM,UAAQC,cAAAA,IAAK;AACnB,UAAM,QAAM;AAAA,MACX,UAAS;AAAA,QACR,OAAM;AAAA,UACL,EAAC,UAAU,MAAK,cAAa,QAAO;AAAA,UACpC,EAAC,WAAU,GAAG,WAAU,IAAI,cAAa,gCAAmC;AAAA,QAC5E;AAAA,MACD;AAAA,MACD,UAAS;AAAA,QACR,OAAM;AAAA,UACL,EAAC,UAAS,MAAK,cAAa,QAAO;AAAA,UACnC,EAAC,WAAU,GAAE,WAAU,IAAI,cAAa,gCAA+B;AAAA,QACvE;AAAA,MACD;AAAA,IACF;AACA,UAAM,QAAM,MAAI;AACfC,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAI;AAAA,MACN,CAAE;AAAA,IACF;AACA,UAAM,QAAM,MAAI;AACf,YAAM,QAAMC,YAAAA,aAAc;AAC1B,cAAQ,MAAM,WAAW,KAAM,SAAK;AACnCD,sBAAAA,MAAY,MAAA,OAAA,yBAAA,aAAY,GAAG;AAE3B,cAAM,MAAM,SAAS,UAAS,SAAS,QAAQ,EAAE,KAAK,OAAME,SAAK;AAChEF,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAM;AAAA,UACV,CAAI;AACD,gBAAM,MAAM,YAAYG,cAAO,QAAC,gBAAe,CAAE;AACjDH,wBAAAA,MAAI,UAAU;AAAA,YACb,KAAI;AAAA,UACR,CAAI;AAAA,QACJ,CAAG,EAAE,MAAM,SAAK;AACbA,wBAAAA,MAAY,MAAA,OAAA,yBAAA,iBAAgB,GAAG;AAAA,QAClC,CAAG;AAAA,MAGH,CAAE,EAAE,MAAM,SAAK;AACbA,sBAAAA,MAAA,MAAA,OAAA,yBAAY,SAAQ,GAAG;AAAA,MACzB,CAAE;AAAA,IACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtFA,GAAG,WAAWI,SAAe;"}