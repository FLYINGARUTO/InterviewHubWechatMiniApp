{"version":3,"file":"publish.js","sources":["pages/articles/publish.vue","pages/articles/publish.vue?type=page"],"sourcesContent":["<template>\r\n\t<view style=\"padding: 20px;\">\r\n\t\t<uni-forms ref=\"pubFormRef\" :rules=\"pubFormRule\" :model=\"pubForm\">\r\n\t\t\t<uni-forms-item name=\"title\" required=\"\">\r\n\t\t\t\t<uni-easyinput placeholder=\"title\" v-model=\"pubForm.title\"></uni-easyinput>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"categoryId\" required=\"\">\r\n\t\t\t\t<uni-data-select v-model=\"pubForm.categoryId\" :localdata=\"category\" ></uni-data-select>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"details\" required=\"\">\r\n\t\t\t\t<editor placeholder=\"share your stories...\" class=\"detailsEditor\" @input=\"detailInput\" id=\"myEditor\" ref=\"editorRef\"></editor>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<button type=\"primary\" @click=\"publish\">publish</button>\r\n\t\t</uni-forms>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tonLoad\r\n\t} from \"@dcloudio/uni-app\"\r\n\timport {\r\n\t\tref\r\n\t} from 'vue'\r\n\timport baseApi from '@/api/base.js'\r\n\tconst pubFormRef = ref()\r\n\tconst pubForm = ref({})\r\n\tconst pubFormRule = ref({\r\n\t\ttitle: {\r\n\t\t\trules: [{\n\t\t\t\trequired : true,\n\t\t\t\terrorMessage: 'please type the title '\n\t\t\t},{\r\n\t\t\t\tminLength: 5,\r\n\t\t\t\tmaxLength: 50,\r\n\t\t\t\terrorMessage: 'length of title must range from {minLength} to {maxLength}'\r\n\t\t\t}]\r\n\t\t},\n\t\tcategoryId: {\n\t\t\trules: [{\n\t\t\t\trequired : true,\n\t\t\t\terrorMessage: 'please select the category '\n\t\t\t}]\n\t\t},\n\t\tdetails: {\n\t\t\trules: [{\n\t\t\t\trequired : true,\n\t\t\t\terrorMessage: 'description cannot left empty '\n\t\t\t}]\n\t\t},\r\n\t})\r\n\tconst category = ref([])\r\n\tonLoad(async () => {\r\n\t\tlet res = await baseApi.getParamListByBaseName('articleType')\n\t\tcategory.value = res.data.data.map(item=>{\n\t\t\treturn {\n\t\t\t\tvalue: item.paramValue,\n\t\t\t\ttext: item.paramName\n\t\t\t}\n\t\t})\r\n\r\n\r\n\t})\r\n\timport articleApi from '@/api/article.js'\r\n\tconst publish = () => {\r\n\t\tpubFormRef.value.validate()\n\t\t.then(\t() => {\n\t\t\tconsole.log(\"form is valid : \",pubForm.value)\n\t\t\tarticleApi.publish(pubForm.value).then(res=>{\n\t\t\t\t\tconsole.log('published: ',res.data)\n\t\t\t\t\tpubForm.value={}\n\t\t\t\t\tpubFormRef.value.clearValidate()//clear the first two inputs\n\t\t\t\t\tclearDetail()//clear the editor\n\t\t\t\t\t// uni.showToast({\n\t\t\t\t\t// \ttitle:\"post success\"\n\t\t\t\t\t// })\n\t\t\t\t\tuni.redirectTo({\n\t\t\t\t\t\turl:'/pages/articles/publish-success'\n\t\t\t\t\t})\n\t\t\t})\n\t\t})\t\r\n\t\t.catch(()=>{\n\t\t\tconsole.log(\"form is invalid : \",pubForm.value)\n\t\t})\r\n\t}\n\t//editorçš„listener\n\tconst detailInput = (e)=>{\n\t\tpubForm.value.details= e.detail.html\n\t}\n\t//clear the editor\n\tconst clearDetail=()=>{\n\t\tuni.createSelectorQuery().select(\"#myEditor\").context(res=>{\n\t\t\tres.context.setContents({ html: '' })\n\t\t}).exec()\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.detailsEditor {\r\n\t\tborder-radius: 5px;\r\n\t\tpadding: 10px;\r\n\t\tborder: 1px solid #e5e5e5;\r\n\t\theight: 100vh-20;\r\n\t}\r\n</style>","import MiniProgramPage from '/Users/flyingbuta/Desktop/WechatMini/frontend/pages/articles/publish.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","baseApi","uni","articleApi","MiniProgramPage"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAyBC,UAAM,aAAaA,cAAAA,IAAK;AACxB,UAAM,UAAUA,cAAG,IAAC,EAAE;AACtB,UAAM,cAAcA,cAAAA,IAAI;AAAA,MACvB,OAAO;AAAA,QACN,OAAO,CAAC;AAAA,UACP,UAAW;AAAA,UACX,cAAc;AAAA,QAClB,GAAK;AAAA,UACD,WAAW;AAAA,UACX,WAAW;AAAA,UACX,cAAc;AAAA,QAClB,CAAI;AAAA,MACD;AAAA,MACD,YAAY;AAAA,QACX,OAAO,CAAC;AAAA,UACP,UAAW;AAAA,UACX,cAAc;AAAA,QAClB,CAAI;AAAA,MACD;AAAA,MACD,SAAS;AAAA,QACR,OAAO,CAAC;AAAA,UACP,UAAW;AAAA,UACX,cAAc;AAAA,QAClB,CAAI;AAAA,MACD;AAAA,IACH,CAAE;AACD,UAAM,WAAWA,cAAG,IAAC,EAAE;AACvBC,kBAAAA,OAAO,YAAY;AAClB,UAAI,MAAM,MAAMC,iBAAQ,uBAAuB,aAAa;AAC5D,eAAS,QAAQ,IAAI,KAAK,KAAK,IAAI,UAAM;AACxC,eAAO;AAAA,UACN,OAAO,KAAK;AAAA,UACZ,MAAM,KAAK;AAAA,QACX;AAAA,MACJ,CAAG;AAAA,IAGH,CAAE;AAED,UAAM,UAAU,MAAM;AACrB,iBAAW,MAAM,SAAU,EAC1B,KAAM,MAAM;AACZC,sBAAY,MAAA,MAAA,OAAA,oCAAA,oBAAmB,QAAQ,KAAK;AAC5CC,oBAAU,WAAC,QAAQ,QAAQ,KAAK,EAAE,KAAK,SAAK;AAC1CD,wBAAA,MAAA,MAAA,OAAA,oCAAY,eAAc,IAAI,IAAI;AAClC,kBAAQ,QAAM,CAAE;AAChB,qBAAW,MAAM,cAAe;AAChC,sBAAa;AAIbA,wBAAAA,MAAI,WAAW;AAAA,YACd,KAAI;AAAA,UACV,CAAM;AAAA,QACN,CAAI;AAAA,MACJ,CAAG,EACA,MAAM,MAAI;AACVA,sBAAA,MAAA,MAAA,OAAA,oCAAY,sBAAqB,QAAQ,KAAK;AAAA,MACjD,CAAG;AAAA,IACD;AAED,UAAM,cAAc,CAAC,MAAI;AACxB,cAAQ,MAAM,UAAS,EAAE,OAAO;AAAA,IAChC;AAED,UAAM,cAAY,MAAI;AACrBA,oBAAG,MAAC,oBAAmB,EAAG,OAAO,WAAW,EAAE,QAAQ,SAAK;AAC1D,YAAI,QAAQ,YAAY,EAAE,MAAM,GAAE,CAAE;AAAA,MACpC,CAAA,EAAE,KAAM;AAAA,IACT;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7FF,GAAG,WAAWE,SAAe;"}