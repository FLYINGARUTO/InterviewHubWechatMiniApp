{"version":3,"names":["pubFormRef","common_vendor","ref","pubForm","pubFormRule","title","rules","required","errorMessage","minLength","maxLength","categoryId","details","category","onLoad","api_base","baseApi","getParamListByBaseName","then","res","value","data","map","item","paramValue","text","paramName","publish","validate","index","__f__","api_article","articleApi","clearValidate","clearDetail","showToast","catch","detailInput","e","detail","html","_a","editorRef","setContents","wx","createPage","_sfc_main"],"sources":["publish.vue","publish.vue?type=page"],"sourcesContent":["<template>\r\n\t<view style=\"padding: 20px;\">\r\n\t\t<uni-forms ref=\"pubFormRef\" :rules=\"pubFormRule\" :model=\"pubForm\">\r\n\t\t\t<uni-forms-item name=\"title\" required=\"\">\r\n\t\t\t\t<uni-easyinput placeholder=\"title\" v-model=\"pubForm.title\"></uni-easyinput>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"categoryId\" required=\"\">\r\n\t\t\t\t<uni-data-select v-model=\"pubForm.categoryId\" :localdata=\"category\" ></uni-data-select>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"details\" required=\"\">\r\n\t\t\t\t<editor placeholder=\"share your stories...\" class=\"detailsEditor\" @input=\"detailInput\" id=\"myEditor\" ref=\"editorRef\"></editor>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<button type=\"primary\" @click=\"publish\">publish</button>\r\n\t\t</uni-forms>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tonLoad\r\n\t} from \"@dcloudio/uni-app\"\r\n\timport {\r\n\t\tref\r\n\t} from 'vue'\r\n\timport baseApi from '@/api/base.js'\r\n\tconst pubFormRef = ref()\r\n\tconst pubForm = ref({})\r\n\tconst pubFormRule = ref({\r\n\t\ttitle: {\r\n\t\t\trules: [{\n\t\t\t\trequired : true,\n\t\t\t\terrorMessage: 'please type the title '\n\t\t\t},{\r\n\t\t\t\tminLength: 5,\r\n\t\t\t\tmaxLength: 50,\r\n\t\t\t\terrorMessage: 'length of title must range from {minLength} to {maxLength}'\r\n\t\t\t}]\r\n\t\t},\n\t\tcategoryId: {\n\t\t\trules: [{\n\t\t\t\trequired : true,\n\t\t\t\terrorMessage: 'please select the category '\n\t\t\t}]\n\t\t},\n\t\tdetails: {\n\t\t\trules: [{\n\t\t\t\trequired : true,\n\t\t\t\terrorMessage: 'description cannot left empty '\n\t\t\t}]\n\t\t},\r\n\t})\r\n\tconst category = ref([])\r\n\tonLoad(() => {\r\n\t\tbaseApi.getParamListByBaseName('articleType').then(res => {\r\n\t\t\t//console.log('-----articleType-----:', res.data.data)\r\n\t\t\tcategory.value = res.data.data.map(item => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tvalue: item.paramValue,\r\n\t\t\t\t\ttext: item.paramName\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t})\r\n\r\n\r\n\t})\r\n\timport articleApi from '@/api/article.js'\r\n\tconst publish = () =>{\r\n\t\tpubFormRef.value.validate().then(() => {\n\t\t\tconsole.log(\"form is valid : \",pubForm.value)\n\t\t\tarticleApi.publish(pubForm.value).then(res=>{\n\t\t\t\tconsole.log('published: ',res.data)\n\t\t\t\tpubForm.value={}\n\t\t\t\tpubFormRef.value.clearValidate()//clear the first two inputs\n\t\t\t\tclearDetail()//clear the editor\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle:\"post success\"\n\t\t\t\t})\n\t\t\t})\r\n\r\n\t\t\t}\r\n\t\t).catch(()=>{\n\t\t\tconsole.log(\"form is invalid : \",pubForm.value)\n\t\t})\r\n\t}\n\t//editorçš„listener\n\tconst detailInput = (e)=>{\n\t\tpubForm.value.details= e.detail.html\n\t}\n\t//clear the editor\n\tconst clearDetail=()=>{\n\t\teditorRef.value?.setContents({html:\"\"})\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.detailsEditor {\r\n\t\tborder-radius: 5px;\r\n\t\tpadding: 10px;\r\n\t\tborder: 1px solid #e5e5e5;\r\n\t\theight: 100vh-35;\r\n\t}\r\n</style>","import MiniProgramPage from '/Users/flyingbuta/Desktop/WechatMini/frontend/pages/articles/publish.vue'\nwx.createPage(MiniProgramPage)"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAyBC,IAAMA,UAAA,GAAaC,aAAA,CAAAC,GAAA,EAAK;IACxB,IAAMC,OAAA,GAAUF,aAAA,CAAGC,GAAA,CAAC,EAAE;IACtB,IAAME,WAAA,GAAcH,aAAA,CAAAC,GAAA,CAAI;MACvBG,KAAA,EAAO;QACNC,KAAA,EAAO,CAAC;UACPC,QAAA,EAAW;UACXC,YAAA,EAAc;QAClB,GAAK;UACDC,SAAA,EAAW;UACXC,SAAA,EAAW;UACXF,YAAA,EAAc;QAClB,CAAI;MACD;MACDG,UAAA,EAAY;QACXL,KAAA,EAAO,CAAC;UACPC,QAAA,EAAW;UACXC,YAAA,EAAc;QAClB,CAAI;MACD;MACDI,OAAA,EAAS;QACRN,KAAA,EAAO,CAAC;UACPC,QAAA,EAAW;UACXC,YAAA,EAAc;QAClB,CAAI;MACD;IACH,CAAE;IACD,IAAMK,QAAA,GAAWZ,aAAA,CAAGC,GAAA,CAAC,EAAE;IACvBD,aAAA,CAAAa,MAAA,CAAO,YAAM;MACZC,QAAA,CAAAC,OAAA,CAAQC,sBAAA,CAAuB,aAAa,EAAEC,IAAA,CAAK,UAAAC,GAAA,EAAO;QAEzDN,QAAA,CAASO,KAAA,GAAQD,GAAA,CAAIE,IAAA,CAAKA,IAAA,CAAKC,GAAA,CAAI,UAAAC,IAAA,EAAQ;UAC1C,OAAO;YACNH,KAAA,EAAOG,IAAA,CAAKC,UAAA;YACZC,IAAA,EAAMF,IAAA,CAAKG;UACX;QACL,CAAI;MAEJ,CAAG;IAGH,CAAE;IAED,IAAMC,OAAA,GAAU,SAAVA,QAAA,EAAe;MACpB3B,UAAA,CAAWoB,KAAA,CAAMQ,QAAA,EAAU,CAACV,IAAA,CAAK,YAAM;QACtCjB,aAAA,CAAY4B,KAAA,CAAAC,KAAA,gEAAmB3B,OAAA,CAAQiB,KAAK;QAC5CW,WAAA,CAAUC,UAAA,CAACL,OAAA,CAAQxB,OAAA,CAAQiB,KAAK,EAAEF,IAAA,CAAK,UAAAC,GAAA,EAAK;UAC3ClB,aAAA,CAAY4B,KAAA,CAAAC,KAAA,2DAAcX,GAAA,CAAIE,IAAI;UAClClB,OAAA,CAAQiB,KAAA,GAAM,CAAE;UAChBpB,UAAA,CAAWoB,KAAA,CAAMa,aAAA,EAAe;UAChCC,WAAA,EAAa;UACbjC,aAAA,CAAA4B,KAAA,CAAIM,SAAA,CAAU;YACb9B,KAAA,EAAM;UACX,CAAK;QACL,CAAI;MAEA,EACD,CAAC+B,KAAA,CAAM,YAAI;QACXnC,aAAA,CAAA4B,KAAA,CAAAC,KAAA,4CAAY,sBAAqB3B,OAAA,CAAQiB,KAAK;MACjD,CAAG;IACD;IAED,IAAMiB,WAAA,GAAc,SAAdA,YAAeC,CAAA,EAAI;MACxBnC,OAAA,CAAQiB,KAAA,CAAMR,OAAA,GAAS0B,CAAA,CAAEC,MAAA,CAAOC,IAAA;IAChC;IAED,IAAMN,WAAA,GAAY,SAAZA,YAAA,EAAgB;;MACrB,CAAAO,EAAA,GAAAC,SAAA,CAAUtB,KAAA,KAAV,gBAAAqB,EAAA,CAAiBE,WAAA,CAAY;QAACH,IAAA,EAAK;MAAE;IACrC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3FFI,EAAA,CAAGC,UAAA,CAAWC,SAAe","ignoreList":[]}